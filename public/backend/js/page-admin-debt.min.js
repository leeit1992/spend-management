!function(t){"use strict";new(Backbone.View.extend({el:"#atl-page-handle-debt",formClassError:"md-input-danger",events:{"submit #atl-form-debt":"handleForm","click .atl-manage-debt-delete-js":"removeDebt","click .atl-action-apply-js":"actionManage","click .atl-manage-debt-day-js":"searchManageDay","click .atl-manage-debt-month-js":"searchManageMonth"},errorFormTpl:_.template('<div class="uk-notify-message <%= classes %>">\t\t\t\t\t\t\t\t        <a class="uk-close"></a>\t\t\t\t\t\t\t\t        <div>\t\t\t\t\t\t\t\t           <%= message %>\t\t\t\t\t\t\t\t        </div>\t\t\t\t\t\t\t\t    </div>'),initialize:function(){var e=this;t(window).load(function(){var a=t(".atl-notify-js",e.el).attr("data-notify");if(a){var l=e.errorFormTpl({message:a,classes:"uk-notify-message-success"});t(".atl-notify-js",e.el).html(l).show(),setTimeout(function(){t(".atl-notify-js",e.el).fadeOut()},3e3)}}),ATLLIB.checkAll(this.el)},handleForm:function(e){var a=this,l=t(".atl-required-js",this.el),r=new Array;return t.each(l,function(e,l){0===t(l).val().length?(t(l).addClass(a.formClassError),r.push(e)):(t(l).removeClass(a.formClassError),r.splice(e,1))}),0===r.length&&(this.handleDebt(e),!1)},handleDebt:function(e){var a={formData:t("#atl-form-debt",this.el).serialize()};altair_helpers.content_preloader_show(),t.ajax({url:ATLDATA.adminUrl+"/validate-debt",type:"POST",data:a,success:function(t){altair_helpers.content_preloader_hide();var e=JSON.parse(t);e.status&&(window.location=location.href=ATLDATA.adminUrl+"/edit-debt/"+e.id)}})},removeDebt:function(e){var a=t(e.currentTarget).attr("data-id");return UIkit.modal.confirm("Are you sure?",function(){var l={id:a};t.post(ATLDATA.adminUrl+"/delete-debt",l,function(a){t(e.currentTarget).closest("tr").remove(),UIkit.modal.alert("Delete Success!")})}),!1},actionManage:function(e){var a=t(e.currentTarget).closest(".atl-action-manage").find("select[name=atl-action-manage]").val(),l=new Array;if("delete"==a){altair_helpers.content_preloader_show(),t(".atl-checkbox-child-js",this.el).each(function(){this.checked&&l.push(t(this).val())});var r={id:l};t.post(ATLDATA.adminUrl+"/delete-debt",r,function(e){var a=JSON.parse(e);t.each(l,function(e,a){t(".atl-debt-item-"+a).remove()}),altair_helpers.content_preloader_hide(),a.status?UIkit.modal.alert("Delete Success!"):UIkit.modal.alert("Delete False!")})}else UIkit.modal.alert("Please choose Action!")},searchManageDay:function(e){var a=this;altair_helpers.content_preloader_show();var l={getBy:"day",startDate:t(".atl-debt-start-day").val(),endDate:t(".atl-debt-end-day").val()};return t.get(ATLDATA.adminUrl+"/ajax-manage-debt",l,function(e){var l=JSON.parse(e);t(".atl-list-debt-js",a.el).html(l.output),t(".atl-list-debt-not-js",a.el).hide(),altair_helpers.content_preloader_hide(),t("ul.uk-pagination",a.el).hide()}),!1},searchManageMonth:function(e){var a=this;altair_helpers.content_preloader_show();var l={getBy:"month",dataMonth:t(".atl-debt-month").val(),dataYear:t(".atl-debt-year").val()};return t.get(ATLDATA.adminUrl+"/ajax-manage-debt",l,function(e){var l=JSON.parse(e);t(".atl-list-debt-js",a.el).html(l.output),t(".atl-list-debt-not-js",a.el).hide(),altair_helpers.content_preloader_hide(),t("ul.uk-pagination",a.el).hide()}),!1}}))}(jQuery);