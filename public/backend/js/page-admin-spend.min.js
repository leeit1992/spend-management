!function(e){"use strict";new(Backbone.View.extend({el:"#atl-page-handle-spend",formClassError:"md-input-danger",events:{"submit #atl-form-spend":"handleForm","click .atl-manage-spend-delete-js":"removeSpend","click .atl-action-apply-js":"actionManage","click .atl-manage-spend-day-js":"searchManageDay","click .atl-manage-spend-month-js":"searchManageMonth"},errorFormTpl:_.template('<div class="uk-notify-message <%= classes %>">\t\t\t\t\t\t\t\t        <a class="uk-close"></a>\t\t\t\t\t\t\t\t        <div>\t\t\t\t\t\t\t\t           <%= message %>\t\t\t\t\t\t\t\t        </div>\t\t\t\t\t\t\t\t    </div>'),initialize:function(){var t=this;e(window).load(function(){var a=e(".atl-notify-js",t.el).attr("data-notify");if(a){var n=t.errorFormTpl({message:a,classes:"uk-notify-message-success"});e(".atl-notify-js",t.el).html(n).show(),setTimeout(function(){e(".atl-notify-js",t.el).fadeOut()},3e3)}}),ATLLIB.checkAll(this.el)},handleForm:function(t){var a=this,n=e(".atl-required-js",this.el),l=new Array;return e.each(n,function(t,n){0===e(n).val().length?(e(n).addClass(a.formClassError),l.push(t)):(e(n).removeClass(a.formClassError),l.splice(t,1))}),0===l.length&&(this.handleSpend(t),!1)},handleSpend:function(t){var a={formData:e("#atl-form-spend",this.el).serialize()};altair_helpers.content_preloader_show(),e.ajax({url:ATLDATA.adminUrl+"/validate-spend",type:"POST",data:a,success:function(e){altair_helpers.content_preloader_hide();var t=JSON.parse(e);t.status&&(window.location=location.href=ATLDATA.adminUrl+"/edit-spend/"+t.id)}})},removeSpend:function(t){var a=e(t.currentTarget).attr("data-id");return UIkit.modal.confirm("Are you sure?",function(){var n={id:a};e.post(ATLDATA.adminUrl+"/delete-spend",n,function(a){e(t.currentTarget).closest("tr").remove(),UIkit.modal.alert("Delete Success!")})}),!1},actionManage:function(t){var a=e(t.currentTarget).closest(".atl-action-manage").find("select[name=atl-action-manage]").val(),n=new Array;if("delete"==a){altair_helpers.content_preloader_show(),e(".atl-checkbox-child-js",this.el).each(function(){this.checked&&n.push(e(this).val())});var l={id:n};e.post(ATLDATA.adminUrl+"/delete-spend",l,function(t){var a=JSON.parse(t);e.each(n,function(t,a){e(".atl-spend-item-"+a).remove()}),altair_helpers.content_preloader_hide(),a.status?UIkit.modal.alert("Delete Success!"):UIkit.modal.alert("Delete False!")})}else UIkit.modal.alert("Please choose Action!")},searchManageDay:function(t){var a=this;altair_helpers.content_preloader_show();var n={getBy:"day",startDate:e(".atl-spend-start-day").val(),endDate:e(".atl-spend-end-day").val()};return e.get(ATLDATA.adminUrl+"/ajax-manage-spend",n,function(t){var n=JSON.parse(t);e(".atl-list-spend-js",a.el).html(n.output),e(".atl-list-spend-not-js",a.el).hide(),altair_helpers.content_preloader_hide(),e("ul.uk-pagination",a.el).hide()}),!1},searchManageMonth:function(t){var a=this;altair_helpers.content_preloader_show();var n={getBy:"month",dataMonth:e(".atl-spend-month").val(),dataYear:e(".atl-spend-year").val()};return e.get(ATLDATA.adminUrl+"/ajax-manage-spend",n,function(t){var n=JSON.parse(t);e(".atl-list-spend-js",a.el).html(n.output),e(".atl-list-spend-not-js",a.el).hide(),altair_helpers.content_preloader_hide(),e("ul.uk-pagination",a.el).hide()}),!1}}))}(jQuery);