!function(t){"use strict";new(Backbone.View.extend({el:"#atl-page-handle-user",formClassError:"md-input-danger",events:{"submit #atl-form-user":"handleForm"},errorFormTpl:_.template('<div class="uk-notify-message <%= classes %>">\t\t\t\t\t\t\t\t        <a class="uk-close"></a>\t\t\t\t\t\t\t\t        <div>\t\t\t\t\t\t\t\t           <%= message %>\t\t\t\t\t\t\t\t        </div>\t\t\t\t\t\t\t\t    </div>'),initialize:function(){var e=this;t(window).load(function(){var a=t(".atl-notify-js",e.el).attr("data-notify");if(a){var s=e.errorFormTpl({message:a,classes:"uk-notify-message-success"});t(".atl-notify-js",e.el).html(s).show(),setTimeout(function(){t(".atl-notify-js",e.el).fadeOut()},3e3)}})},handleForm:function(e){var a=this,s=t(".atl-required-js",this.el),r=new Array;t.each(s,function(e,s){0===t(s).val().length?(t(s).addClass(a.formClassError),r.push(e)):(t(s).removeClass(a.formClassError),r.splice(e,1))});var l=t("input[name=atl_user_pass]",this.el),n=t("input[name=atl_user_cf_pass]",this.el);return 0===l.val().length||l.val()!=n.val()?(l.addClass(a.formClassError),n.addClass(a.formClassError),r.push(1)):(l.removeClass(a.formClassError),n.removeClass(a.formClassError)),0===r.length&&(this.handleUser(e),!1)},handleUser:function(e){var a=this,s=t("input[name=atl_user_avatar]",this.el)[0].files[0],r=new FormData;r.append("avatar",s),r.append("formData",t("#atl-form-user",this.el).serialize()),altair_helpers.content_preloader_show(),t.ajax({url:ATLDATA.adminUrl+"/validate-user",type:"POST",data:r,processData:!1,contentType:!1,success:function(e){altair_helpers.content_preloader_hide();var s=JSON.parse(e);if(!1===s.status){var r="";t.each(s.message,function(t,e){r+=a.errorFormTpl({message:e,classes:"uk-notify-message-danger"})}),t(".atl-notify-js",a.el).html(r).show(),setTimeout(function(){t(".atl-notify-js",a.el).fadeOut()},3e3)}else window.location=location.href=ATLDATA.adminUrl+"/edit-user/"+s.id}})}}))}(jQuery);